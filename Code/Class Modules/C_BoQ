Public BoQRow As Long

Private Sub Add_val_B(colBumn, value)
'
'Shorter way to add value int ocell
'
        Cells(BoQRow, BoQIndex(colBumn)).Interior.ColorIndex = COLOR_BOQ_EDIT
        Cells(BoQRow, BoQIndex(colBumn)).Formula = value
End Sub

Public Sub SpreadFoundation()
'
'Stopa fundamentowa - 5D-KI-STB-OB-FU-EF
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "Foundation Slab"
            'NOTHING TO DO
         
        Case "5dki Einzelfundament Fundament"
            Add_val_B R_PERIMETER, "=2*(" & colB(R_WIDTH) & "+" & colB(R_LENGTH) & ")"
            
    End Select
    
    Add_val_B R_5D4D_CODE, "FST"
    Add_val_B R_THICKNESS, foundThickness
    Add_val_B R_FORMWORK, thickness_M_Perimeter
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_NAME, "Stopa fundamentowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"", H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m, ""&TEXT(MIN(" & colB(R_WIDTH) & "," & colB(R_LENGTH) & "),""0,00"")&""x""&TEXT(MAX(" & colB(R_WIDTH) & "," & colB(R_LENGTH) & "),""0,00"")&""m"""
'FORMAT
    Cells(BoQRow, BoQIndex(R_REINFORCEMENT_INDICATOR)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub

Public Sub StripFoundation()
'
'Ława fundamentowa - 5D-KI-STB-OB-FU-SF
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "Foundation Slab"
            Add_val_B R_THICKNESS, foundThickness
            
        Case "5dki Streifenfundament Skelettbau"
            Add_val_B R_THICKNESS, hohe_DE
            Add_val_B R_WIDTH, breite_DE
            Add_val_B R_AREA, "=" & colB(R_WIDTH) & "*" & colB(R_LENGTH_CUT)
            Add_val_B R_PERIMETER, "=2*(" & colB(R_WIDTH) & "+" & colB(R_LENGTH_CUT) & ")"
    End Select

    Add_val_B R_5D4D_CODE, "FLW"
    Add_val_B R_FORMWORK, thickness_M_Perimeter
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_NAME, "Ława fundamentowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"", B=""&TEXT(" & colB(R_WIDTH) & ",""0,00"")&""m, H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
'FORMAT
    Cells(BoQRow, BoQIndex(R_REINFORCEMENT_INDICATOR)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub

Public Sub FoundationSlab()
'
'Płyta/Rampa fundamentowa
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "Foundation Slab"
            Add_val_B R_THICKNESS, foundThickness
    End Select
    
    Add_val_B R_5D4D_CODE, "FPL"
    Add_val_B R_FORMWORK, thickness_M_Perimeter
    Add_val_B R_REINFORCEMENT, reinforcement
    'NAME DEPENDS OF TYPE
    If InStr(Cells(BoQRow, BoQIndex(R_TYPE)).Text, "5dki Bodenplattenrampe") <> 0 Then
        Add_val_B R_NAME, "Rampa żelbetowa"
    ElseIf InStr(Cells(BoQRow, BoQIndex(R_TYPE)).Text, "5dki Bodenplatte") <> 0 Then
        Add_val_B R_NAME, "Płyta fundamentowa"
    Else
        Add_val_B R_NAME, "-1"
    End If

    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&IF(" & colB(R_MATERIAL_TYPE) & "<>"""","" "",)&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"", H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
End Sub

Public Sub FoundationSlab_PitElevator()
'
'Płyta fundamentowa podszybia
'
    FoundationSlab
    Add_val_B R_NAME, "Płyta fundamentowa podszybia"
End Sub

Public Sub FoundationSlab_Machine()
'
'Fundament pod maszyny
'
    FoundationSlab
    Add_val_B R_NAME, "Fundament pod maszyny"
End Sub

Public Sub FoundationSlab_FiberReinforced()
'
'Płyta fundamentowa ze zbrojeniem rozproszonym
'
    FoundationSlab
    Add_val_B R_NAME, "Płyta fundamentowa ze zbrojeniem rozproszonym"
End Sub

Public Sub FoundationSlab_RollerConcrete()
'
'Płyta fundamentowa z betonu wałowanego
'
    FoundationSlab
    Add_val_B R_NAME, "Płyta fundamentowa z betonu wałowanego"
End Sub

Public Sub Wall_Concrete()
'
'Ściana żelbetowa
'
    Add_val_B R_5D4D_CODE, "SCZ"
    Add_val_B R_FORMWORK, "=2*" & colB(R_LENGTH) & "*" & colB(R_UNCONNECT_HEIGHT)
    Add_val_B R_FORMWORK_HEIGHT, "=" & colB(R_UNCONNECT_HEIGHT)
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_INTERVAL_HEIGHT, intervalHeight
    Add_val_B R_NAME, "Ściana żelbetowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&IF(" & colB(R_MATERIAL_TYPE) & "="""","""","" ""&" & colB(R_MATERIAL_TYPE) & ")&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, B=""&TEXT(" & colB(R_WIDTH) & ",""0,00"")&""m"""
End Sub

Public Sub Wall_Concrete_1S()
'
'Ściana żelbetowa jednostronnie szalowana
'
    Wall_Concrete
    Add_val_B R_NAME, "Ściana żelbetowa jednostronnie szalowana"
    Add_val_B R_FORMWORK, "=" & colB(R_LENGTH) & "*" & colB(R_UNCONNECT_HEIGHT)
End Sub

Public Sub Wall_Duct()
'
'Ściana żelbetowa szachtu
'
    Wall_Concrete
    Add_val_B R_5D4D_CODE, "SCS"
    Add_val_B R_NAME, "Ściana żelbetowa szachtu"
End Sub

Public Sub Wall_Disc()
'
'Tarcza żelbetowa
'
    Wall_Concrete
    Add_val_B R_NAME, "Tarcza żelbetowa"
End Sub

Public Sub Wall_Attic()
'
'Attyka/nadciąg żelbetowy
'
    Wall_Concrete
    Add_val_B R_NAME, "Attyka żelbetowa"
    
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "5dki Überzug Skelettbau"
            Add_val_B R_WIDTH, breite_DE
            Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
    End Select
    
    Add_val_B R_5D4D_CODE, "ATT"
End Sub

Public Sub Wall_ElevatorPit()
'
'Ściana żelbetowa podszybia
'
    Wall_Concrete
    Add_val_B R_NAME, "Ściana żelbetowa podszybia"
End Sub

Public Sub Wall_Filigran()
'
'Ściana prefabrykowana typu Filigran
'
    Wall_Concrete
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_NAME, "Prefabrykowana ściana typu Filigran"
    Add_val_B R_FORMWORK, ""
    Cells(BoQRow, BoQIndex(R_FORMWORK)).Interior.ColorIndex = 0
End Sub

Public Sub Beam()
'
'Podciąg żelbetowy - 5D-KI-STB-OB-TR-UZ
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "Basic Wall"
            Add_val_B R_LENGTH_CUT, "=" & colB(R_LENGTH)
            
        Case "5dki Unterzug Skelettbau"
            Add_val_B R_WIDTH, breite_DE
            Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
    End Select
    
    Add_val_B R_5D4D_CODE, "POD"
    Add_val_B R_FORMWORK, "=" & colB(R_LENGTH_CUT) & "*(" & colB(R_WIDTH) & "+2*" & colB(R_UNCONNECT_HEIGHT) & ")"
    Add_val_B R_REINFORCEMENT, "=" & colB(R_VOLUME2) & "*0.001*" & colB(R_REINFORCEMENT_INDICATOR)
    Add_val_B R_INTERVAL_HEIGHT, intervalHeight
    Add_val_B R_NAME, "Podciąg żelbetowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, B=""&TEXT(" & colB(R_WIDTH) & ",""0,00"")&""m, H=""&TEXT(" & colB(R_UNCONNECT_HEIGHT) & ",""0,00"")&""m (H.cal=""&TEXT(" & colB(R_UNCONNECT_HEIGHT) & "+" & colB(R_COMMENT) & ",""0,00"")&""m)"""
    Add_val_B R_VOLUME2, "=" & colB(R_WIDTH) & "*(" & colB(R_UNCONNECT_HEIGHT) & "+" & colB(R_COMMENT) & ")*" & colB(R_LENGTH_CUT)
    Add_val_B R_PERIMETER, "=2*(" & colB(R_WIDTH) & "+" & colB(R_UNCONNECT_HEIGHT) & ")"
    
    Cells(BoQRow, BoQIndex(R_VOLUME2)).ClearComments
    Cells(BoQRow, BoQIndex(R_VOLUME2)).AddComment "Objetość podciągu z półką"
    Cells(BoQRow, BoQIndex(R_COMMENT)).ClearComments
    Cells(BoQRow, BoQIndex(R_COMMENT)).AddComment "Wysokość półki"
'FORMAT
    Cells(BoQRow, BoQIndex(R_REINFORCEMENT_INDICATOR)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
    Cells(BoQRow, BoQIndex(R_FORMWORK_HEIGHT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
    Cells(BoQRow, BoQIndex(R_COMMENT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub

Private Sub BrickWall()
'
'Ściana murowana
'
    Add_val_B R_5D4D_CODE, "SCM"
    
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&IF(" & colB(R_MATERIAL_TYPE) & "="""","""","" ""&" & colB(R_MATERIAL_TYPE) & ")&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, B=""&TEXT(" & colB(R_WIDTH) & ",""0,00"")&""m"""
    Add_val_B R_INTERVAL_HEIGHT, intervalHeight
    Add_val_B R_FORMWORK_HEIGHT, "=" & colB(R_UNCONNECT_HEIGHT)
End Sub

Public Sub BrickWall_Porotherm()
'
'Ściana z Porothermu
'
    BrickWall
    Add_val_B R_NAME, "Ściana z Porothermu"
End Sub

Public Sub BrickWall_Ytong()
'
'Ściana z bloczków Ytong
'
    BrickWall
    Add_val_B R_NAME, "Ściana z bloczków Ytong"
End Sub

Public Sub BrickWall_SilkaSmall()
'
'Ściana z silikatów drobnowymiarowych, np Silka E
'
    BrickWall
    Add_val_B R_NAME, "Ściana z silikatów drobnowymiarowych"
End Sub

Public Sub BrickWall_SilkaBig()
'
'Ściana z silikatów wielkowymiarowych, np Silka Tempo
'
    BrickWall
    Add_val_B R_NAME, "Ściana z silikatów wielkowymiarowych"
End Sub

Public Sub BrickWall_SilkaSzacht()
'
'Obudowa szachtu z silikatów
'
    BrickWall
    Add_val_B R_NAME, "Obudowa szachtu z silikatów"
End Sub

Public Sub BrickWall_TeknoAmber()
'
'Ściana z TeknoAmerBlok
'
    BrickWall
    Add_val_B R_NAME, "Ściana z TeknoAmberBlok"
End Sub

Public Sub BrickWall_Tang()
'
'Trzpień ściany murowanej
'
    Add_val_B R_5D4D_CODE, "TRZ"

    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_THICKNESS, tiefe_DE
    Add_val_B R_NAME, "Trzpień ściany murowanej"
    Add_val_B R_FORMWORK, "=2*(" & colB(R_THICKNESS) & "+2*0.15)*" & colB(R_LENGTH)
    Add_val_B R_FORMWORK_HEIGHT, "=" & colB(R_LENGTH)
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&IF(" & colB(R_MATERIAL_TYPE) & "="""","""","" ""&" & colB(R_MATERIAL_TYPE) & ")&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&"", B=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
    Add_val_B R_INTERVAL_HEIGHT, "=""do ""&IF(" & colB(R_LENGTH) & "<=3.5,""3,50"",TEXT(CEILING(" & colB(R_LENGTH) & ",0.25),""0,00""))"
    Add_val_B R_REINFORCEMENT, reinforcement
End Sub

Public Sub BrickWall_Grommet()
'
'Wieniec ściany murowanej
'
    Add_val_B R_5D4D_CODE, "TRZ"
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
    Add_val_B R_NAME, "Wieniec ściany murowanej"
    Add_val_B R_FORMWORK, "=2*(" & colB(R_UNCONNECT_HEIGHT) & "+2*0.15)*" & colB(R_LENGTH)
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&IF(" & colB(R_MATERIAL_TYPE) & "="""","""","" ""&" & colB(R_MATERIAL_TYPE) & ")&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"", H=""&TEXT(" & colB(R_UNCONNECT_HEIGHT) & ",""0,00"")&""m"""
    Add_val_B R_REINFORCEMENT, reinforcement
End Sub

Public Sub LeanConcrete()
'
'Chudy beton
'
    Add_val_B R_5D4D_CODE, "CHB"
    
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "Foundation Slab"
            Add_val_B R_THICKNESS, foundThickness
            
        Case "5dki Sauberkeitsschicht unter Vouten"
            Add_val_B R_THICKNESS, "=" & colB(R_DICKE_DE)
    End Select

    Add_val_B R_NAME, "Chudy beton"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")"
End Sub

Public Sub LeanConcrete_Fulfil()
'
'Chudy beton wypełniający
'
    Add_val_B R_5D4D_CODE, "CHB"
    LeanConcrete
    Add_val_B R_NAME, "Chudy beton wypełniający"
End Sub

Public Sub SlantingEdges()
'
'Skośna krawędź płyty
'
    Add_val_B R_5D4D_CODE, "KRA"
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_MATERIAL_STRUCT, "=" & colB(R_MATERIAL)
    Add_val_B R_NAME, "Skośna krawędź płyty"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")"
End Sub

Public Sub colBumn()
'
'Słup
'
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_INTERVAL_HEIGHT, "=""do ""&IF(" & colB(R_LENGTH) & "<=3.5,""3,50"",TEXT(CEILING(" & colB(R_LENGTH) & ",0.25),""0,00""))"
    Add_val_B R_FORMWORK_HEIGHT, "=" & colB(R_LENGTH)
End Sub

Public Sub Column_Rec()
'
'Słup żelbetowy prostokątny
'
    colBumn
    Add_val_B R_5D4D_CODE, "SLP"
    Add_val_B R_THICKNESS, tiefe_DE
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_FORMWORK, "=" & colB(R_LENGTH) & "*(" & colB(R_THICKNESS) & "+" & colB(R_WIDTH) & ")*2"
    Add_val_B R_AREA, "=" & colB(R_THICKNESS) & "*" & colB(R_WIDTH)
    Add_val_B R_NAME, "Słup żelbetowy prostokątny"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, ""&TEXT(MIN(" & colB(R_THICKNESS) & "," & colB(R_WIDTH) & "),""0,00"")&""x""&TEXT(MAX(" & colB(R_THICKNESS) & "," & colB(R_WIDTH) & "),""0,00"")&""m"""
End Sub

Public Sub Column_Round()
'
'Słup żelbetowy okrągły
'
    colBumn
    Add_val_B R_5D4D_CODE, "SLO"
    Add_val_B R_THICKNESS, "=" & colB(R_DIAMETER)
    Add_val_B R_FORMWORK, "=" & colB(R_LENGTH) & "*2*PI()*" & colB(R_DIAMETER) & "/2"
    Add_val_B R_AREA, "=PI()*(" & colB(R_DIAMETER) & "/2)^2"
    Add_val_B R_NAME, "Słup żelbetowy okrągły"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, " & ChrW(216) & "=""&TEXT(" & colB(R_DIAMETER) & ",""0,00"")&""m"""
End Sub

Public Sub Column_Rec_Pilaser()
'
'Pilaster żelbetowy
'
    Column_Rec
    Add_val_B R_5D4D_CODE, "SLP"
    Add_val_B R_NAME, "Pilaster żelbetowy"
End Sub

Public Sub FlaringHeads()
'
'Głowica żelbetowa
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "Floor"
            Add_val_B R_FORMWORK, "=" & colB(R_AREA)
            Add_val_B R_VOLUME2, "=" & colB(R_VOLUME) & "+" & colB(R_COMMENT) & "*" & colB(R_AREA)
            Add_val_B R_FORMWORK2, "=" & colB(R_PERIMETER) & "*" & colB(R_THICKNESS)
            
            Cells(BoQRow, BoQIndex(R_FORMWORK2)).ClearComments
            Cells(BoQRow, BoQIndex(R_FORMWORK2)).AddComment "Powierzchnia szalunku bocznego głowicy"
    
        Case "5dki STB-Stützenkopf rund"
            Add_val_B R_THICKNESS, hohe_DE
            Add_val_B R_AREA, "=PI()*(" & colB(R_DIAMETER) & "/2)^2"
            Add_val_B R_VOLUME2, "=" & colB(R_VOLUME) & "+PI()*(" & colB(R_DIAMETER) & "/2+" & colB(R_THICKNESS) & "/TAN(" & colB(R_SLOPE) & "))^2*" & colB(R_COMMENT)
            Add_val_B R_FORMWORK, "=PI()*(" & colB(R_DIAMETER) & "+" & colB(R_THICKNESS) & "/TAN(" & colB(R_SLOPE) & "))*" & colB(R_THICKNESS) & "/SIN(" & colB(R_SLOPE) & ")"
            Add_val_B R_SLOPE, "=RADIANS(MID(" & colB(R_ANGLE) & ",1,FIND(""" & ChrW(176) & """," & colB(R_ANGLE) & ")-1))"

        Case "5dki STB-Stützenkopf rechteckig"
            Add_val_B R_THICKNESS, hohe_DE
            Add_val_B R_WIDTH, tiefe_DE
            Add_val_B R_LENGTH, breite_DE

            Add_val_B R_AREA, "=" & colB(R_LENGTH) & "*" & colB(R_WIDTH)
            Add_val_B R_VOLUME2, "=" & colB(R_VOLUME) & "+(" & colB(R_WIDTH) & "+2*" & colB(R_THICKNESS) & "/TAN(" & colB(R_SLOPE) & "))*(" & colB(R_LENGTH) & "+2*" & colB(R_THICKNESS) & "/TAN(" & colB(R_SLOPE) & "))*" & colB(R_COMMENT)
            Add_val_B R_PERIMETER, "=2*(4*" & colB(R_THICKNESS) & "/TAN(" & colB(R_SLOPE) & ")+" & colB(R_WIDTH) & "+" & colB(R_LENGTH) & ")"
            Add_val_B R_FORMWORK, "=" & colB(R_PERIMETER) & "*" & colB(R_THICKNESS) & "/SIN(" & colB(R_SLOPE) & ")"
            Add_val_B R_SLOPE, "=RADIANS(MID(" & colB(R_ANGLE) & ",1,FIND(""" & ChrW(176) & """," & colB(R_ANGLE) & ")-1))"
    End Select
    
    Add_val_B R_5D4D_CODE, "STR"
    Add_val_B R_REINFORCEMENT, "=" & colB(R_VOLUME2) & "*0.001*" & colB(R_REINFORCEMENT_INDICATOR)
    Add_val_B R_INTERVAL_HEIGHT, intervalHeight
    Add_val_B R_NAME, "Głowica żelbetowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""

    Cells(BoQRow, BoQIndex(R_VOLUME2)).ClearComments
    Cells(BoQRow, BoQIndex(R_VOLUME2)).AddComment "Objetość głowicy z półką"
    Cells(BoQRow, BoQIndex(R_COMMENT)).ClearComments
    Cells(BoQRow, BoQIndex(R_COMMENT)).AddComment "Wysokość półki"
'FORMAT
    Cells(BoQRow, BoQIndex(R_REINFORCEMENT_INDICATOR)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
    Cells(BoQRow, BoQIndex(R_FORMWORK_HEIGHT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
    Cells(BoQRow, BoQIndex(R_COMMENT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub

Public Sub Landing()
'
'Spocznik żelbetowy
'
    Add_val_B R_5D4D_CODE, "SPO"
    Add_val_B R_FORMWORK, "=" & colB(R_AREA)
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_NAME, "Spocznik żelbetowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"", H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
End Sub

Public Sub Stairs()
'
'Bieg schodowy
'
    Add_val_B R_5D4D_CODE, "SCH"
    Add_val_B R_WIDTH, "=" & colB(R_LAUFBREITE_DE)
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_NAME, "Bieg schodowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")"
'FORMAT
    Cells(BoQRow, BoQIndex(R_FORMWORK_HEIGHT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
    Cells(BoQRow, BoQIndex(R_FORMWORK)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub

Public Sub Prefabric_Stairs()
'
'Prefabrykowany bieg schodowy
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_WIDTH, "=" & colB(R_LAUFBREITE_DE)
    Add_val_B R_NAME, "Prefabrykowany bieg schodowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME)
End Sub
Public Sub Prefabric_Landing()
'
'Prefarykowany spocznik - 5D-KI-STB-FT-TRE-POD
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_NAME, "Prefabrykowany spocznik"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
End Sub
Public Sub Floor()
'
'Strop żelbetowy
'
    Add_val_B R_5D4D_CODE, "STR"
    Add_val_B R_FORMWORK, "=" & colB(R_AREA)
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_INTERVAL_HEIGHT, intervalHeight
    Add_val_B R_FORMWORK2, thickness_M_Perimeter
    Add_val_B R_ANGLE, "=DEGREES(ATAN(" & colB(R_SLOPE) & "))"
    Add_val_B R_NAME, "Strop żelbetowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m""&IF(" & colB(R_SLOPE) & "="""","""","", spadek ""&TEXT(" & colB(R_SLOPE) & ",""0%""))"
    
    Cells(BoQRow, BoQIndex(R_FORMWORK2)).ClearComments
    Cells(BoQRow, BoQIndex(R_FORMWORK2)).AddComment "Powierzchnia szalunku bocznego stropu"
'FORMAT
    Cells(BoQRow, BoQIndex(R_FORMWORK_HEIGHT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub
Public Sub Floor_Filigran()
'
'Strop prefabrykowany
'
    Floor
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_NAME, "Prefabrykowany strop typu Filigran"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&IF(" & colB(R_PRESTRESSED) & "=""Yes"","" sprężony"","""")&"" ""&" & colB(R_INTERVAL_HEIGHT) & "&""m, H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m""&IF(" & colB(R_SLOPE) & "="""","""","", spadek ""&TEXT(" & colB(R_SLOPE) & ",""0%""))"
End Sub

Public Sub Bracket()
'
'Wspornik - 5D-KI-STB-OB-M-KB
'
    Add_val_B R_5D4D_CODE, "WSP"
    Add_val_B R_THICKNESS, tiefe_DE
    Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
    Add_val_B R_LENGTH, "=" & colB(R_VOLUME) & "/" & colB(R_THICKNESS) & "/" & colB(R_UNCONNECT_HEIGHT)
    Add_val_B R_AREA, "=" & colB(R_THICKNESS) & "*" & colB(R_UNCONNECT_HEIGHT)
    Add_val_B R_FORMWORK, "=" & colB(R_LENGTH) & "*(" & colB(R_THICKNESS) & "+" & colB(R_UNCONNECT_HEIGHT) & ")"
    Add_val_B R_REINFORCEMENT, reinforcement
    Add_val_B R_NAME, "Wspornik żelbetowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE) & "&IF(" & colB(R_WATERPROOF) & "=""Yes"","" W8"","""")&"", B=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m, H=""&TEXT(" & colB(R_UNCONNECT_HEIGHT) & ",""0,00"")&""m"""
End Sub

Public Sub Console()
'
'Konsola żelbetowa - 5D-KI-STB-OB-M-KON
'
    Bracket
    Add_val_B R_5D4D_CODE, "KON"
    Add_val_B R_LENGTH, breite_DE
    Add_val_B R_NAME, "Konsola żelbetowa"
End Sub

Public Sub Foundation_VibrationInsulation()
'
'Mata antywibracyjna pod fundamenty pod maszyny
'
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_THICKNESS, foundThickness
    Add_val_B R_NAME, "Mata antywibracyjna pod fundamenty pod maszyny"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_THICKNESS) & "*100&""cm"""
End Sub

Public Sub PartitionPanel()
'
'Dylatacja ze styropianu
'
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_NAME, "Dylatacja ze styropianu"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_WIDTH) & "*100&""cm"""
End Sub

Public Sub InteriorInsulation()
'
'Izolacja wewnętrzna
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "5dki Wärmedämmung innen vertikal Linie"
            Add_val_B R_WIDTH, breite_DE
            Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
            Add_val_B R_LENGTH, "=" & colB(R_VOLUME) & "/" & colB(R_WIDTH) & "/" & colB(R_UNCONNECT_HEIGHT)
    End Select
    
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_NAME, "Izolacja wewnętrzna"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&IF(" & colB(R_THICKNESS) & "," & colB(R_THICKNESS) & "," & colB(R_WIDTH) & ")*100&""cm"""
End Sub

Public Sub WallInsulation()
'
'Izolacja ściany
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "5dki Perimeterdämmung Wand vertikal Linie"
            Add_val_B R_WIDTH, breite_DE
            Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
            Add_val_B R_LENGTH, "=" & colB(R_VOLUME) & "/" & colB(R_WIDTH) & "/" & colB(R_UNCONNECT_HEIGHT)
    End Select
    
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_NAME, "Izolacja ściany"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&IF(" & colB(R_THICKNESS) & "," & colB(R_THICKNESS) & "," & colB(R_WIDTH) & ")*100&""cm"""
End Sub

Public Sub Foundation_Insulation()
'
'Izolacja fundamentu
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "5dki Perimeterdämmung unter Vouten"
            Add_val_B R_THICKNESS, "=" & colB(R_DICKE_DE)
    End Select
    
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_NAME, "Izolacja fundamentu"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&IF(" & colB(R_THICKNESS) & "," & colB(R_THICKNESS) & "," & colB(R_WIDTH) & ")*100&""cm"""
End Sub

Public Sub FoamGlass()
'
'Podsypka keramzytowa
'
    Select Case Cells(BoQRow, BoQIndex(R_FAMILY)).Text
        Case "5dki Schaumglasschotter unter Vouten"
            Add_val_B R_THICKNESS, "=" & colB(R_DICKE_DE)
    End Select
    
    Add_val_B R_5D4D_CODE, "KER"
    Add_val_B R_NAME, "Podsypka keramzytowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_THICKNESS) & "*100&""cm"""
End Sub

Public Sub ElastomericSlidingWasher_Strip()
'
'Podkładka elastomerowa pasmowa
'
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_NAME, "Podkładka elastomerowa pasmowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_WIDTH) & "*100&""cm"""
End Sub

Public Sub Elastomeric_Pref_Stairs()
'
'Podkładka elastomerowa pasmowa boczna pod schody
'
    Add_val_B R_5D4D_CODE, "IZO"
    Add_val_B R_NAME, "Podkładka elastomerowa pod schody"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME)
End Sub

Public Sub ElastomericSlidingWasher_Point()
'
'Podkładka elastomerowa punktowa
'
    Add_val_B R_5D4D_CODE, "IZO"
    
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_NAME, "Podkładka elastomerowa punktowa"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_WIDTH) & "*100&""cm"""
    
'Name depends of Type
    If InStr(Cells(BoQRow, BoQIndex(R_TYPE)).Text, "5dki Punkt-Gleitlager") <> 0 Then
        Add_val_B R_NAME, "Podkładka elastomerowa punktowa stała"

    ElseIf InStr(Cells(BoQRow, BoQIndex(R_TYPE)).Text, "5dki Punkt-Festlager") <> 0 Then
        Add_val_B R_NAME, "Podkładka elastomerowa punktowa ślizgowa"

    Else
        Add_val_B R_NAME, "-1"
        
    End If
End Sub

Public Sub Comax_T1()
'
'Zbrojenie Comax jednorzędowe
'
    Comax
    Add_val_B R_NAME, "Zbrojenie Comax jednorzędowe"
End Sub

Public Sub Comax_T5()
'
'Zbrojenie Comax dwurzędowe
'
    Comax
    Add_val_B R_NAME, "Zbrojenie Comax dwurzędowe"
End Sub
Public Sub Comax()
'
'Zbrojenie Comax
'
    Add_val_B R_5D4D_CODE, "CMX"
    Add_val_B R_THICKNESS, hohe_DE
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_LENGTH, "=" & colB(R_VOLUME) & "/" & colB(R_WIDTH) & "/" & colB(R_THICKNESS)
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME)
End Sub

Public Sub Prefabric_Beam()
'
'Prefarykowana belka - 5D-KI-STB-FT-TR-UZ
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_UNCONNECT_HEIGHT, hohe_DE
    Add_val_B R_NAME, "Prefabrykowana belka"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" B=""&TEXT(" & colB(R_WIDTH) & ",""0,00"")&""m, H=""&TEXT(" & colB(R_UNCONNECT_HEIGHT) & ",""0,00"")&""m"""
End Sub

Public Sub Prefabric_Slab()
'
'Prefarykowany strop
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_NAME, "Prefabrykowany strop"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
End Sub

Public Sub Prefabric_Slab_Hollow()
'
'Prefarykowany strop kanałowy
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_NAME, "Prefabrykowany strop kanałowy"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" H=""&TEXT(" & colB(R_THICKNESS) & ",""0,00"")&""m"""
End Sub

Public Sub Prefabric_SlabTT()
'
'Prefarykowana płyta TT z nadbetonem - 5D-KI-STB-FT-DE-TTP
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_NAME, "Prefarykowana płyta TT z nadbetonem"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&" & colB(R_MATERIAL_TYPE)
'FORMAT
    Cells(BoQRow, BoQIndex(R_FORMWORK_HEIGHT)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
End Sub

Public Sub Prefabric_Column()
'
'Prefarykowany slup - 5D-KI-STB-FT-ST-REC
'
    Add_val_B R_5D4D_CODE, "PREF"
    Add_val_B R_THICKNESS, tiefe_DE
    Add_val_B R_WIDTH, breite_DE
    Add_val_B R_AREA, "=" & colB(R_THICKNESS) & "*" & colB(R_WIDTH)
    Add_val_B R_INTERVAL_HEIGHT, "=""do ""&IF(" & colB(R_LENGTH) & "<=3.5,""3,50"",TEXT(CEILING(" & colB(R_LENGTH) & ",0.25),""0,00""))"
    Add_val_B R_NAME, "Prefarykowany słup"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME) & "&"" ""&TEXT(MIN(" & colB(R_THICKNESS) & "," & colB(R_WIDTH) & "),""0,00"")&""x""&TEXT(MAX(" & colB(R_THICKNESS) & "," & colB(R_WIDTH) & "),""0,00"")&""m"""
End Sub

Public Sub Steel()
'
'Konstrukcja stalowa
'

'Name depends of Family
    If InStr(Cells(BoQRow, BoQIndex(R_FAMILY)).Text, "Schweißprofil") <> 0 Then
    
        If InStr(Cells(BoQRow, BoQIndex(R_TYPE)).Text, "Verbund") <> 0 Then
            Add_val_B R_NAME, "Konstrukcja stalowa spawana z wypełnieniem betonowym"
        Else
            Add_val_B R_NAME, "Konstrukcja stalowa spawana"
        End If
            
    Else
        If InStr(Cells(BoQRow, BoQIndex(R_TYPE)).Text, "Verbund") <> 0 Then
            Add_val_B R_NAME, "Konstrukcja stalowa z wypełnieniem betonowym"
        Else
            Add_val_B R_NAME, "Konstrukcja stalowa"
        End If
            
    End If

    Add_val_B R_5D4D_CODE, "STA"
    Add_val_B R_MATERIAL_TYPE, "=IFERROR(MID(" & colB(R_TYPE) & ",(IFERROR(FIND(""S355""," & colB(R_TYPE) & "),Find(""S235""," & colB(R_TYPE) & "))),4),-1)"
    Add_val_B R_PROFILE, "=IFERROR(MID(" & colB(R_TYPE) & ",1,find(" & colB(R_MATERIAL_TYPE) & "," & colB(R_TYPE) & ")-2),-1)"
    Add_val_B R_REINFORCEMENT, "=IFERROR(IF(" & colB(R_LENGTH_CUT) & "," & colB(R_LENGTH_CUT) & "," & colB(R_LENGTH) & ")*1.1*VLOOKUP(" & colB(R_TYPE) & ",STA_Profile,5,0),)/1000"
    Add_val_B R_FORMWORK, "=IFERROR(IF(" & colB(R_LENGTH_CUT) & "," & colB(R_LENGTH_CUT) & "," & colB(R_LENGTH) & ")*1.1*VLOOKUP(" & colB(R_TYPE) & ",STA_Profile,6,0),)"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME)
End Sub

Public Sub EarthMoving()
'
'Roboty ziemne
'
    Add_val_B R_5D4D_CODE, "ZIE"
    
    Add_val_B R_NAME, "Roboty ziemne"
    Add_val_B R_NAME_FINAL, "=" & colB(R_NAME)
End Sub

'---------------------------------------------------------------------------------------------
'------------------------------------------FUNCTIONS------------------------------------------
'---------------------------------------------------------------------------------------------

Private Function reinforcement()
    Cells(BoQRow, BoQIndex(R_REINFORCEMENT_INDICATOR)).Interior.ColorIndex = COLOR_BOQ_MUST_HAVE
    reinforcement = "=" & colB(R_VOLUME) & "*0.001*" & colB(R_REINFORCEMENT_INDICATOR)
End Function

Private Function thickness_M_Perimeter()
    thickness_M_Perimeter = "=" & colB(R_THICKNESS) & "*" & colB(R_PERIMETER)
End Function

Private Function foundThickness()
    foundThickness = "=" & colB(R_FOUND_THICKNESS)
End Function

Private Function hohe_DE()
    hohe_DE = "=" & colB(R_HOHE_DE)
End Function

Private Function breite_DE()
    breite_DE = "=" & colB(R_BREITE_DE)
End Function

Private Function tiefe_DE()
    tiefe_DE = "=" & colB(R_TIEFE_DE)
End Function

Private Function intervalHeight()
    intervalHeight = "=""do ""&IF(" & colB(R_FORMWORK_HEIGHT) & "<=3.5,""3,50"",TEXT(CEILING(" & colB(R_FORMWORK_HEIGHT) & ",0.25),""0,00""))"
End Function

